var EasyMarker=function(t){"use strict";function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var i=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},o=function(t){return Object(i(t))},r={}.hasOwnProperty,s=function(t,e){return r.call(t,e)},h=n(function(t){var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)}),a=(h.version,n(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),l=n(function(t){var e=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:h.version,mode:"pure",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),u=0,c=Math.random(),f=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++u+c).toString(36))},d=l("keys"),g=function(t){return d[t]||(d[t]=f(t))},p=g("IE_PROTO"),v=Object.prototype,y=Object.getPrototypeOf||function(t){return t=o(t),s(t,p)?t[p]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?v:null},m=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},w=function(t,e,n){if(m(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}},x=function(t){return"object"==typeof t?null!==t:"function"==typeof t},k=function(t){if(!x(t))throw TypeError(t+" is not an object!");return t},E=function(t){try{return!!t()}catch(t){return!0}},b=!E(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),S=a.document,T=x(S)&&x(S.createElement),R=function(t){return T?S.createElement(t):{}},N=!b&&!E(function(){return 7!=Object.defineProperty(R("div"),"a",{get:function(){return 7}}).a}),M=function(t,e){if(!x(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!x(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!x(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!x(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},O=Object.defineProperty,C={f:b?Object.defineProperty:function(t,e,n){if(k(t),e=M(e,!0),k(n),N)try{return O(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},_=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},L=b?function(t,e,n){return C.f(t,e,_(1,n))}:function(t,e,n){return t[e]=n,t},I=function(t,e,n){var i,o,r,l=t&I.F,u=t&I.G,c=t&I.S,f=t&I.P,d=t&I.B,g=t&I.W,p=u?h:h[e]||(h[e]={}),v=p.prototype,y=u?a:c?a[e]:(a[e]||{}).prototype;for(i in u&&(n=e),n)(o=!l&&y&&void 0!==y[i])&&s(p,i)||(r=o?y[i]:n[i],p[i]=u&&"function"!=typeof y[i]?n[i]:d&&o?w(r,a):g&&y[i]==r?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(r):f&&"function"==typeof r?w(Function.call,r):r,f&&((p.virtual||(p.virtual={}))[i]=r,t&I.R&&v&&!v[i]&&L(v,i,r)))};I.F=1,I.G=2,I.S=4,I.P=8,I.B=16,I.W=32,I.U=64,I.R=128;var P=I,A=function(t,e){var n=(h.Object||{})[t]||Object[t],i={};i[t]=e(n),P(P.S+P.F*E(function(){n(1)}),"Object",i)};A("getPrototypeOf",function(){return function(t){return y(o(t))}});var H=h.Object.getPrototypeOf,j=n(function(t){t.exports={default:H,__esModule:!0}}),B=e(j),F=e(n(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}}));P(P.S+P.F*!b,"Object",{defineProperty:C.f});var D=h.Object,G=function(t,e,n){return D.defineProperty(t,e,n)},W=n(function(t){t.exports={default:G,__esModule:!0}});e(W);var z,K=e(n(function(t,e){e.__esModule=!0;var n,i=(n=W)&&n.__esModule?n:{default:n};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,i.default)(t,o.key,o)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()})),$=Math.ceil,Y=Math.floor,q=function(t){return isNaN(t=+t)?0:(t>0?Y:$)(t)},U=L,V={},J={}.toString,X=function(t){return J.call(t).slice(8,-1)},Q=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==X(t)?t.split(""):Object(t)},Z=function(t){return Q(i(t))},tt=Math.min,et=function(t){return t>0?tt(q(t),9007199254740991):0},nt=Math.max,it=Math.min,ot=(z=!1,function(t,e,n){var i,o=Z(t),r=et(o.length),s=function(t,e){return(t=q(t))<0?nt(t+e,0):it(t,e)}(n,r);if(z&&e!=e){for(;r>s;)if((i=o[s++])!=i)return!0}else for(;r>s;s++)if((z||s in o)&&o[s]===e)return z||s||0;return!z&&-1}),rt=g("IE_PROTO"),st=function(t,e){var n,i=Z(t),o=0,r=[];for(n in i)n!=rt&&s(i,n)&&r.push(n);for(;e.length>o;)s(i,n=e[o++])&&(~ot(r,n)||r.push(n));return r},ht="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),at=Object.keys||function(t){return st(t,ht)},lt=b?Object.defineProperties:function(t,e){k(t);for(var n,i=at(e),o=i.length,r=0;o>r;)C.f(t,n=i[r++],e[n]);return t},ut=a.document,ct=ut&&ut.documentElement,ft=g("IE_PROTO"),dt=function(){},gt=function(){var t,e=R("iframe"),n=ht.length;for(e.style.display="none",ct.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),gt=t.F;n--;)delete gt.prototype[ht[n]];return gt()},pt=Object.create||function(t,e){var n;return null!==t?(dt.prototype=k(t),n=new dt,dt.prototype=null,n[ft]=t):n=gt(),void 0===e?n:lt(n,e)},vt=n(function(t){var e=l("wks"),n=a.Symbol,i="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=i&&n[t]||(i?n:f)("Symbol."+t))}).store=e}),yt=C.f,mt=vt("toStringTag"),wt=function(t,e,n){t&&!s(t=n?t:t.prototype,mt)&&yt(t,mt,{configurable:!0,value:e})},xt={};L(xt,vt("iterator"),function(){return this});var kt,Et=function(t,e,n){t.prototype=pt(xt,{next:_(1,n)}),wt(t,e+" Iterator")},bt=vt("iterator"),St=!([].keys&&"next"in[].keys()),Tt=function(){return this},Rt=function(t,e,n,i,o,r,s){Et(n,e,i);var h,a,l,u=function(t){if(!St&&t in g)return g[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},c=e+" Iterator",f="values"==o,d=!1,g=t.prototype,p=g[bt]||g["@@iterator"]||o&&g[o],v=p||u(o),m=o?f?u("entries"):v:void 0,w="Array"==e&&g.entries||p;if(w&&(l=y(w.call(new t)))!==Object.prototype&&l.next&&wt(l,c,!0),f&&p&&"values"!==p.name&&(d=!0,v=function(){return p.call(this)}),s&&(St||d||!g[bt])&&L(g,bt,v),V[e]=v,V[c]=Tt,o)if(h={values:f?v:u("values"),keys:r?v:u("keys"),entries:m},s)for(a in h)a in g||U(g,a,h[a]);else P(P.P+P.F*(St||d),e,h);return h},Nt=(kt=!0,function(t,e){var n,o,r=String(i(t)),s=q(e),h=r.length;return s<0||s>=h?kt?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===h||(o=r.charCodeAt(s+1))<56320||o>57343?kt?r.charAt(s):n:kt?r.slice(s,s+2):o-56320+(n-55296<<10)+65536});Rt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Nt(e,n),this._i+=t.length,{value:t,done:!1})});var Mt=function(t,e){return{value:e,done:!!t}};Rt(Array,"Array",function(t,e){this._t=Z(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Mt(1)):Mt(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");V.Arguments=V.Array;for(var Ot=vt("toStringTag"),Ct="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),_t=0;_t<Ct.length;_t++){var Lt=Ct[_t],It=a[Lt],Pt=It&&It.prototype;Pt&&!Pt[Ot]&&L(Pt,Ot,Lt),V[Lt]=V.Array}var At={f:vt},Ht=At.f("iterator"),jt=n(function(t){t.exports={default:Ht,__esModule:!0}});e(jt);var Bt=n(function(t){var e=f("meta"),n=C.f,i=0,o=Object.isExtensible||function(){return!0},r=!E(function(){return o(Object.preventExtensions({}))}),h=function(t){n(t,e,{value:{i:"O"+ ++i,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!x(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,e)){if(!o(t))return"F";if(!n)return"E";h(t)}return t[e].i},getWeak:function(t,n){if(!s(t,e)){if(!o(t))return!0;if(!n)return!1;h(t)}return t[e].w},onFreeze:function(t){return r&&a.NEED&&o(t)&&!s(t,e)&&h(t),t}}}),Ft=(Bt.KEY,Bt.NEED,Bt.fastKey,Bt.getWeak,Bt.onFreeze,C.f),Dt=function(t){var e=h.Symbol||(h.Symbol={});"_"==t.charAt(0)||t in e||Ft(e,t,{value:At.f(t)})},Gt={f:Object.getOwnPropertySymbols},Wt={f:{}.propertyIsEnumerable},zt=Array.isArray||function(t){return"Array"==X(t)},Kt=ht.concat("length","prototype"),$t={f:Object.getOwnPropertyNames||function(t){return st(t,Kt)}},Yt=$t.f,qt={}.toString,Ut="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Vt={f:function(t){return Ut&&"[object Window]"==qt.call(t)?function(t){try{return Yt(t)}catch(t){return Ut.slice()}}(t):Yt(Z(t))}},Jt=Object.getOwnPropertyDescriptor,Xt={f:b?Jt:function(t,e){if(t=Z(t),e=M(e,!0),N)try{return Jt(t,e)}catch(t){}if(s(t,e))return _(!Wt.f.call(t,e),t[e])}},Qt=Bt.KEY,Zt=Xt.f,te=C.f,ee=Vt.f,ne=a.Symbol,ie=a.JSON,oe=ie&&ie.stringify,re=vt("_hidden"),se=vt("toPrimitive"),he={}.propertyIsEnumerable,ae=l("symbol-registry"),le=l("symbols"),ue=l("op-symbols"),ce=Object.prototype,fe="function"==typeof ne&&!!Gt.f,de=a.QObject,ge=!de||!de.prototype||!de.prototype.findChild,pe=b&&E(function(){return 7!=pt(te({},"a",{get:function(){return te(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=Zt(ce,e);i&&delete ce[e],te(t,e,n),i&&t!==ce&&te(ce,e,i)}:te,ve=function(t){var e=le[t]=pt(ne.prototype);return e._k=t,e},ye=fe&&"symbol"==typeof ne.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ne},me=function(t,e,n){return t===ce&&me(ue,e,n),k(t),e=M(e,!0),k(n),s(le,e)?(n.enumerable?(s(t,re)&&t[re][e]&&(t[re][e]=!1),n=pt(n,{enumerable:_(0,!1)})):(s(t,re)||te(t,re,_(1,{})),t[re][e]=!0),pe(t,e,n)):te(t,e,n)},we=function(t,e){k(t);for(var n,i=function(t){var e=at(t),n=Gt.f;if(n)for(var i,o=n(t),r=Wt.f,s=0;o.length>s;)r.call(t,i=o[s++])&&e.push(i);return e}(e=Z(e)),o=0,r=i.length;r>o;)me(t,n=i[o++],e[n]);return t},xe=function(t){var e=he.call(this,t=M(t,!0));return!(this===ce&&s(le,t)&&!s(ue,t))&&(!(e||!s(this,t)||!s(le,t)||s(this,re)&&this[re][t])||e)},ke=function(t,e){if(t=Z(t),e=M(e,!0),t!==ce||!s(le,e)||s(ue,e)){var n=Zt(t,e);return!n||!s(le,e)||s(t,re)&&t[re][e]||(n.enumerable=!0),n}},Ee=function(t){for(var e,n=ee(Z(t)),i=[],o=0;n.length>o;)s(le,e=n[o++])||e==re||e==Qt||i.push(e);return i},be=function(t){for(var e,n=t===ce,i=ee(n?ue:Z(t)),o=[],r=0;i.length>r;)!s(le,e=i[r++])||n&&!s(ce,e)||o.push(le[e]);return o};fe||(U((ne=function(){if(this instanceof ne)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===ce&&e.call(ue,n),s(this,re)&&s(this[re],t)&&(this[re][t]=!1),pe(this,t,_(1,n))};return b&&ge&&pe(ce,t,{configurable:!0,set:e}),ve(t)}).prototype,"toString",function(){return this._k}),Xt.f=ke,C.f=me,$t.f=Vt.f=Ee,Wt.f=xe,Gt.f=be,At.f=function(t){return ve(vt(t))}),P(P.G+P.W+P.F*!fe,{Symbol:ne});for(var Se="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Te=0;Se.length>Te;)vt(Se[Te++]);for(var Re=at(vt.store),Ne=0;Re.length>Ne;)Dt(Re[Ne++]);P(P.S+P.F*!fe,"Symbol",{for:function(t){return s(ae,t+="")?ae[t]:ae[t]=ne(t)},keyFor:function(t){if(!ye(t))throw TypeError(t+" is not a symbol!");for(var e in ae)if(ae[e]===t)return e},useSetter:function(){ge=!0},useSimple:function(){ge=!1}}),P(P.S+P.F*!fe,"Object",{create:function(t,e){return void 0===e?pt(t):we(pt(t),e)},defineProperty:me,defineProperties:we,getOwnPropertyDescriptor:ke,getOwnPropertyNames:Ee,getOwnPropertySymbols:be});var Me=E(function(){Gt.f(1)});P(P.S+P.F*Me,"Object",{getOwnPropertySymbols:function(t){return Gt.f(o(t))}}),ie&&P(P.S+P.F*(!fe||E(function(){var t=ne();return"[null]"!=oe([t])||"{}"!=oe({a:t})||"{}"!=oe(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=e=i[1],(x(e)||void 0!==t)&&!ye(t))return zt(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!ye(e))return e}),i[1]=e,oe.apply(ie,i)}}),ne.prototype[se]||L(ne.prototype,se,ne.prototype.valueOf),wt(ne,"Symbol"),wt(Math,"Math",!0),wt(a.JSON,"JSON",!0),Dt("asyncIterator"),Dt("observable");var Oe=h.Symbol,Ce=n(function(t){t.exports={default:Oe,__esModule:!0}});e(Ce);var _e=n(function(t,e){e.__esModule=!0;var n=r(jt),i=r(Ce),o="function"==typeof i.default&&"symbol"==typeof n.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};function r(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof i.default&&"symbol"===o(n.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":o(t)}});e(_e);var Le=e(n(function(t,e){e.__esModule=!0;var n,i=(n=_e)&&n.__esModule?n:{default:n};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}})),Ie=Xt.f;A("getOwnPropertyDescriptor",function(){return function(t,e){return Ie(Z(t),e)}});var Pe=h.Object,Ae=function(t,e){return Pe.getOwnPropertyDescriptor(t,e)},He=n(function(t){t.exports={default:Ae,__esModule:!0}});e(He);var je=e(n(function(t,e){e.__esModule=!0;var n=o(j),i=o(He);function o(t){return t&&t.__esModule?t:{default:t}}e.default=function t(e,o,r){null===e&&(e=Function.prototype);var s=(0,i.default)(e,o);if(void 0===s){var h=(0,n.default)(e);return null===h?void 0:t(h,o,r)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(r):void 0}})),Be=function(t,e){if(k(t),!x(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},Fe={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=w(Function.call,Xt.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return Be(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:Be};P(P.S,"Object",{setPrototypeOf:Fe.set});var De=h.Object.setPrototypeOf,Ge=n(function(t){t.exports={default:De,__esModule:!0}});e(Ge),P(P.S,"Object",{create:pt});var We=h.Object,ze=function(t,e){return We.create(t,e)},Ke=n(function(t){t.exports={default:ze,__esModule:!0}});e(Ke);var $e=e(n(function(t,e){e.__esModule=!0;var n=r(Ge),i=r(Ke),o=r(_e);function r(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,o.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}})),Ye=function(t,e,n,i){try{return i?e(k(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&k(o.call(t)),e}},qe=vt("iterator"),Ue=Array.prototype,Ve=function(t){return void 0!==t&&(V.Array===t||Ue[qe]===t)},Je=function(t,e,n){e in t?C.f(t,e,_(0,n)):t[e]=n},Xe=vt("toStringTag"),Qe="Arguments"==X(function(){return arguments}()),Ze=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Xe))?n:Qe?X(e):"Object"==(i=X(e))&&"function"==typeof e.callee?"Arguments":i},tn=vt("iterator"),en=h.getIteratorMethod=function(t){if(void 0!=t)return t[tn]||t["@@iterator"]||V[Ze(t)]},nn=vt("iterator"),on=!1;try{[7][nn]().return=function(){on=!0}}catch(t){}P(P.S+P.F*!function(t,e){if(!e&&!on)return!1;var n=!1;try{var i=[7],o=i[nn]();o.next=function(){return{done:n=!0}},i[nn]=function(){return o},t(i)}catch(t){}return n}(function(t){}),"Array",{from:function(t){var e,n,i,r,s=o(t),h="function"==typeof this?this:Array,a=arguments.length,l=a>1?arguments[1]:void 0,u=void 0!==l,c=0,f=en(s);if(u&&(l=w(l,a>2?arguments[2]:void 0,2)),void 0==f||h==Array&&Ve(f))for(n=new h(e=et(s.length));e>c;c++)Je(n,c,u?l(s[c],c):s[c]);else for(r=f.call(s),n=new h;!(i=r.next()).done;c++)Je(n,c,u?Ye(r,l,[i.value,c],!0):i.value);return n.length=c,n}});var rn=h.Array.from,sn=n(function(t){t.exports={default:rn,__esModule:!0}});e(sn);var hn=e(n(function(t,e){e.__esModule=!0;var n,i=(n=sn)&&n.__esModule?n:{default:n};e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,i.default)(t)}})),an=Object.assign,ln=!an||E(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=an({},t)[n]||Object.keys(an({},e)).join("")!=i})?function(t,e){for(var n=o(t),i=arguments.length,r=1,s=Gt.f,h=Wt.f;i>r;)for(var a,l=Q(arguments[r++]),u=s?at(l).concat(s(l)):at(l),c=u.length,f=0;c>f;)a=u[f++],b&&!h.call(l,a)||(n[a]=l[a]);return n}:an;P(P.S+P.F,"Object",{assign:ln});var un=h.Object.assign,cn=e(n(function(t){t.exports={default:un,__esModule:!0}}));P(P.S,"Number",{MAX_SAFE_INTEGER:9007199254740991});var fn=e(n(function(t){t.exports={default:9007199254740991,__esModule:!0}})),dn=function(){function t(){F(this,t),this.element=null,this.container=document.body}return K(t,[{key:"createElement",value:function(){}},{key:"mount",value:function(){this.container.appendChild(this.element)}},{key:"show",value:function(){this.style.display="block"}},{key:"hide",value:function(){this.style.display="none"}},{key:"destroy",value:function(){this.element&&this.element.parentElement.removeChild(this.element)}},{key:"style",get:function(){return this.element.style}},{key:"isShow",get:function(){return"none"!==this.style.display&&""!==this.style.display}}]),t}(),gn={NONE:"none",SELECTING:"selecting",FINISH:"finish"},pn={NODE:"node",REGION:"region"},vn={UNDERLINE:"underline",HIGHLIGHT:"highlight"},yn={PC:"pc",MOBILE:"MOBILE"},mn={SELECT:"select",HIGHLIGHT:"highlight"};function wn(t,e,n,i){if(!t||!t&&t.childNodes)return null;for(var o=Number(window.getComputedStyle(t).lineHeight.replace("px","")),r=void 0,s=0;s<t.childNodes.length;s++){var h=t.childNodes[s],a=null;if("#text"===h.nodeName)for(var l=[].concat(hn(h.textContent)),u=document.createRange(),c=void 0,f=0;f<l.length;f++){u.setStart(h,f),u.setEnd(h,f+1);var d=void 0,g=u.getClientRects(),p=void 0;if(g.length>1)p=g[1];else{if(1!==g.length)continue;p=g[0]}var v=((o=o||p.height)-p.height)/2;if(p.top-v<=n&&p.bottom+v>=n){a={x:p.left,y:p.top-v,height:o,index:f,node:h};try{u.setStart(h,f+1),u.setEnd(h,f+2);var y=u.getClientRects();d=y.length>1?y[1]:1===y.length?y[0]:null}catch(t){d=null}var m=void 0===c||c&&c.bottom<=p.top,w=null===d||d&&d.top>=p.bottom;if(e<p.right){var x=e<(p.left+p.right)/2;return(!m||i)&&(x||w&&i)||(a.x+=p.width,a.index+=1),a}w&&(i||(a.x+=p.width,a.index+=1),r=a)}c=p}else{if("#comment"===h.nodeName)continue;var k=wn(h,e,n,i);k&&(r=k)}if(s===t.childNodes.length-1&&r)return r}return null}function xn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=On(t);return{x:n.clientX+e.x,y:n.clientY+e.y}}function kn(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function En(t){if("number"==typeof t)return t;if("string"==typeof t){if(t.indexOf("px")>-1)return Number(t.replace("px",""));if(t.indexOf("rem")>-1){var e=Number((document.documentElement.style.fontSize||"24px").replace("px",""));return Number(t.replace("rem",""))*e}return Number(t)}return 0}function bn(t,e){return t.isSet?(t.y-=e.y,t.x-=e.x,t):t}function Sn(t){for(var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""]).reduce(function(t,e){return""===e?t:""===t?"\\"+e:t+"|\\"+e},""),n=new RegExp("("+e+")"),i=t.split(n),o=[],r=0;r<i.length;r+=2){var s=i[r]+(i[r+1]||"");s.length>0&&o.push(s)}return o}function Tn(t,e,n,i){return n.top-i<=e&&n.bottom+i>=e&&n.left<=t&&n.right>=t}function Rn(t){return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function Nn(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}function Mn(){if("undefined"!=typeof navigator&&navigator.userAgent){var t=navigator.userAgent;return t.indexOf("Tablet")>-1||t.indexOf("Pad")>-1||t.indexOf("Nexus 7")>-1?yn.MOBILE:t.indexOf("Mobi")>-1||t.indexOf("Android")>-1||t.indexOf("iPh")>-1||t.indexOf("FLOW")>-1?yn.MOBILE:yn.PC}return yn.MOBILE}function On(t){return Mn()===yn.MOBILE?t.changedTouches[0]:{clientX:t.clientX,clientY:t.clientY}}function Cn(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=0,r=t.length-1,s=Math.floor((o+r)/2),h=n?e[n]:e;if(h>=(n?t[r][n]:t[r]))return r;if(h<(n?t[o][n]:t[o]))return i?o:-1;for(;o<=r;){if(o===s||r===s)return s;(n?t[s][n]:t[s])>h?r=s:o=s,s=Math.floor((o+r)/2)}return s}function _n(t,e,n){var i=[];return 0===t.width?i:(i.push([t.left-n,t.top-n]),i.push([t.right+n,t.top-n]),i.push([t.right+n,t.bottom+n]),i.push([t.left-n,t.bottom+n]),i.forEach(function(t){t[0]-=e.x,t[1]-=e.y}),i)}var Ln="start",In="end",Pn={color:"#ff6b00"},An=function(t){function e(t,n,i){F(this,e);var o=Le(this,(e.__proto__||B(e)).call(this));return o.container=t,o.type=n,o.options=cn({},Pn,i),o.$position={x:0,y:0},o.$height=0,o.touchCallbackStack=[],o.topPoint=null,o.lineElement=null,o.bottomPoint=null,o.deviceType=Mn(),o.createElement(),o.mount(),o}return $e(e,dn),K(e,[{key:"show",value:function(){this.deviceType!==yn.PC&&(this.style.display="block")}},{key:"moveTo",value:function(t,e){this.style.top=e-this.width+"px",this.style.left=t-this.width/2+"px"}},{key:"createElement",value:function(){this.element=document.createElement("div"),this.style.userSelect="none",this.style.webkitUserSelect="none",this.style.zIndex="30",this.style.transition="top 0.1s, left 0.1s",this.style.display="none",this.style.position="absolute",this.topPoint=document.createElement("div"),this.topPoint.style.borderRadius="50%",this.topPoint.style.margin="auto",this.lineElement=document.createElement("div"),this.lineElement.style.margin="auto",this.lineElement.style.backgroundColor=this.options.color,this.bottomPoint=document.createElement("div"),this.bottomPoint.style.borderRadius="50%",this.bottomPoint.style.margin="auto",this.type===Ln?this.topPoint.style.backgroundColor=this.options.color:this.bottomPoint.style.backgroundColor=this.options.color,this.element.appendChild(this.topPoint),this.element.appendChild(this.lineElement),this.element.appendChild(this.bottomPoint)}},{key:"setCursorSize",value:function(t){var e=this.width+"px";this.style.width=e,this.topPoint.style.height=e,this.topPoint.style.width=e,this.bottomPoint.style.height=e,this.bottomPoint.style.width=e,this.lineElement.style.height=t+"px",this.lineElement.style.width=t/15+"px"}},{key:"inRegion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.deviceType===yn.PC)return{inRegion:!1};var e=this.height,n=fn;return t.y>this.position.y&&t.y<this.position.y+this.height&&(n=Math.abs(t.x-this.position.x)),t.y>=this.position.y+this.with&&(n=kn(t,{x:this.position.x,y:this.position.y+this.height})),t.y<=this.position.y&&(n=kn(t,this.position)),{inRegion:n<=e,distance:n}}},{key:"position",set:function(t){var e=t.x,n=t.y;this.$position={x:e,y:n},this.moveTo(e,n)},get:function(){return this.$position}},{key:"height",get:function(){return this.$height},set:function(t){t!==this.$height&&(this.$height=t,this.setCursorSize(t))}},{key:"width",get:function(){return this.height/4}}]),e}(),Hn=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:L(t,i,e[i]);return t},jn=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t},Bn=n(function(t){var e={},n={},i=t.exports=function(t,i,o,r,s){var h,a,l,u,c=s?function(){return t}:en(t),f=w(o,r,i?2:1),d=0;if("function"!=typeof c)throw TypeError(t+" is not iterable!");if(Ve(c)){for(h=et(t.length);h>d;d++)if((u=i?f(k(a=t[d])[0],a[1]):f(t[d]))===e||u===n)return u}else for(l=c.call(t);!(a=l.next()).done;)if((u=Ye(l,f,a.value,i))===e||u===n)return u};i.BREAK=e,i.RETURN=n}),Fn=vt("species"),Dn=function(t,e){if(!x(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t},Gn=C.f,Wn=Bt.fastKey,zn=b?"_s":"size",Kn=function(t,e){var n,i=Wn(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n},$n={getConstructor:function(t,e,n,i){var o=t(function(t,r){jn(t,o,e,"_i"),t._t=e,t._i=pt(null),t._f=void 0,t._l=void 0,t[zn]=0,void 0!=r&&Bn(r,n,t[i],t)});return Hn(o.prototype,{clear:function(){for(var t=Dn(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[zn]=0},delete:function(t){var n=Dn(this,e),i=Kn(n,t);if(i){var o=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=o),o&&(o.p=r),n._f==i&&(n._f=o),n._l==i&&(n._l=r),n[zn]--}return!!i},forEach:function(t){Dn(this,e);for(var n,i=w(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!Kn(Dn(this,e),t)}}),b&&Gn(o.prototype,"size",{get:function(){return Dn(this,e)[zn]}}),o},def:function(t,e,n){var i,o,r=Kn(t,e);return r?r.v=n:(t._l=r={i:o=Wn(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[zn]++,"F"!==o&&(t._i[o]=r)),t},getEntry:Kn,setStrong:function(t,e,n){Rt(t,e,function(t,n){this._t=Dn(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?Mt(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,Mt(1))},n?"entries":"values",!n,!0),function(t){var e="function"==typeof h[t]?h[t]:a[t];b&&e&&!e[Fn]&&C.f(e,Fn,{configurable:!0,get:function(){return this}})}(e)}},Yn=vt("species"),qn=function(t,e){return new(function(t){var e;return zt(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!zt(e.prototype)||(e=void 0),x(e)&&null===(e=e[Yn])&&(e=void 0)),void 0===e?Array:e}(t))(e)},Un=C.f,Vn=function(t,e){var n=1==t,i=2==t,r=3==t,s=4==t,h=6==t,a=5==t||h,l=e||qn;return function(e,u,c){for(var f,d,g=o(e),p=Q(g),v=w(u,c,3),y=et(p.length),m=0,x=n?l(e,y):i?l(e,0):void 0;y>m;m++)if((a||m in p)&&(d=v(f=p[m],m,g),t))if(n)x[m]=d;else if(d)switch(t){case 3:return!0;case 5:return f;case 6:return m;case 2:x.push(f)}else if(s)return!1;return h?-1:r||s?s:x}}(0);!function(t,e,n,i,o,r){var s=a[t],h=s,l=o?"set":"add",u=h&&h.prototype,c={};b&&"function"==typeof h&&(r||u.forEach&&!E(function(){(new h).entries().next()}))?(h=e(function(e,n){jn(e,h,t,"_c"),e._c=new s,void 0!=n&&Bn(n,o,e[l],e)}),Vn("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in u&&(!r||"clear"!=t)&&L(h.prototype,t,function(n,i){if(jn(this,h,t),!e&&r&&!x(n))return"get"==t&&void 0;var o=this._c[t](0===n?0:n,i);return e?this:o})}),r||Un(h.prototype,"size",{get:function(){return this._c.size}})):(h=i.getConstructor(e,t,o,l),Hn(h.prototype,n),Bt.NEED=!0),wt(h,t),c[t]=h,P(P.G+P.W+P.F,c),r||i.setStrong(h,t,o)}("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=$n.getEntry(Dn(this,"Map"),t);return e&&e.v},set:function(t,e){return $n.def(Dn(this,"Map"),0===t?0:t,e)}},$n,!0);P(P.P+P.R,"Map",{toJSON:function(t){return function(){if(Ze(this)!=t)throw TypeError(t+"#toJSON isn't generic");return Bn(this,!1,(n=[]).push,n,e),n;var e,n}}("Map")});var Jn;Jn="Map",P(P.S,Jn,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}});!function(t){P(P.S,t,{from:function(t){var e,n,i,o,r=arguments[1];return m(this),(e=void 0!==r)&&m(r),void 0==t?new this:(n=[],e?(i=0,o=w(r,arguments[2],2),Bn(t,!1,function(t){n.push(o(t,i++))})):Bn(t,!1,n.push,n),new this(n))}})}("Map");var Xn=h.Map,Qn=e(n(function(t){t.exports={default:Xn,__esModule:!0}})),Zn=function(){function t(){F(this,t),this.y=0,this.x=0,this.width=0,this.height=0}return K(t,[{key:"setAll",value:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}},{key:"equal",value:function(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}},{key:"isSet",get:function(){return 0!==this.y||0!==this.x||0!==this.width||0!==this.height}}]),t}(),ti=function(){function t(e,n){F(this,t),this.node=e,this.offset=n}return K(t,null,[{key:"getSelectText",value:function(t,e){try{return this.getSelectNodeRectAndText(t.node,e.node,t.offset,e.offset).text}catch(t){return console.error("EasyMarkerError:",t),""}}},{key:"getSelectRects",value:function(t,e){var n=new Zn,i=new Zn,o=new Zn;if(!t||!e)return{header:n,body:i,footer:o};if("#text"!==t.node.nodeName||"#text"!==e.node.nodeName)return console.error("The parameters for getting the selection rect should be a TextNode",{startTextNode:t,endTextNode:e}),{header:n,body:i,footer:o};var r=void 0;try{r=this.getSelectNodeRectAndText(t.node,e.node,t.offset,e.offset).rects}catch(t){console.error("EasyMarkerError:",t),r=[]}var s=[];r.forEach(function(t){if(s.length>0){var e=s[s.length-1],n=e.height/2;Math.abs(e.top-t.top)<n&&Math.abs(e.bottom-t.bottom)<n?(e.width+=t.width,e.height=e.height-t.height>0?e.height:t.height,e.top=e.top-t.top<0?e.top:t.top,e.bottom=e.bottom-t.bottom>0?e.bottom:t.bottom):s.push(Rn(t))}else s.push(Rn(t))});var h=0,a=[],l=[];if(s.length>0){var u=s.shift();h=Number(window.getComputedStyle(t.node.parentElement).lineHeight.replace("px",""))||u.height,n.x=u.left,n.width=u.width,n.y=u.top-(h-u.height)/2,n.height=h,a.push(n.x),l.push(u.right)}var c=0;if(s.length>0){var f=s.pop();c=Number(window.getComputedStyle(e.node.parentElement).lineHeight.replace("px",""))||f.height,o.x=f.left,o.width=f.width,o.y=f.top-(c-f.height)/2,o.height=c,a.push(o.x),l.push(f.right)}if(s.length>0){var d=0;s.forEach(function(t){i.x&&i.width?(t.left<i.x&&(i.x=t.left),t.width>i.width&&(i.width=t.width),d<t.right&&(d=t.right)):(i.x=t.left,i.width=t.width,d=t.right)}),a.push(i.x),l.push(d)}var g=Math.min.apply(Math,a);g!==1/0&&(i.x=g);var p=Math.max.apply(Math,l);return p!==-1/0&&(i.width=p-i.x),i.y=n.y+h,o.isSet?i.height=o.y-i.y:(o.x=n.x,o.y=n.y+h),{header:n,body:i,footer:o}}},{key:"getSelectNodeRectAndText",value:function(t,e,n,i){var o={rects:[],text:""};if(t.childNodes.length>0&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var r,s=t.childNodes[0],h=this.getSelectNodeRectAndText(s,e,0,i),a=h.text,l=h.rects;return(r=o.rects).push.apply(r,hn(l)),o.text+=a,o}if("#text"===t.nodeName){var u,c=t===e?i:t.textContent.length;(u=o.rects).push.apply(u,hn(function(t,e,n){var i=document.createRange(),o=void 0===e?0:e,r=void 0===n?t.textContent.length:n;try{return i.setStart(t,o),i.setEnd(t,r),Nn(i.getClientRects())}catch(t){return console.error("EasyMarkerError:",t),[]}}(t,n,c))),o.text+=t.textContent.substring(n,c)}if("IMG"===t.nodeName&&o.rects.push(t.getBoundingClientRect()),t===e)return o;var f=t.nextSibling;if(f){var d,g=this.getSelectNodeRectAndText(f,e,0,i),p=g.text,v=g.rects;(d=o.rects).push.apply(d,hn(v)),o.text+=p}else{for(var y=t.parentNode;y&&null===y.nextSibling;)y=y.parentNode;if(!y)throw new Error("Invalid end node");var m,w=this.getSelectNodeRectAndText(y.nextSibling,e,0,i),x=w.text,k=w.rects;(m=o.rects).push.apply(m,hn(k)),o.text+=x}return o}}]),t}(),ei=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F(this,e);var i=Le(this,(e.__proto__||B(e)).call(this));return i.container=t,i.handler=null,i.mode=n.mode,i.option={items:n.menuItems,isMultiColumnLayout:n.isMultiColumnLayout,topOffset:En(n.topOffset),style:{menu:{fontSize:"0.4rem",backgroundColor:"#262626",fontColor:"#fff",borderRadius:"0.1rem",color:"#fff",border:"0px",display:"inline-block",padding:"0 0.2rem",margin:"auto"},triangle:{marginLeft:"auto",marginRight:"auto",borderTop:"0.2rem solid #262626",borderRight:"0.2rem solid transparent",borderLeft:"0.2rem solid transparent",width:"0",height:"0",marginTop:"-1px"},item:{lineHeight:"1.24rem",padding:"0 0.3rem",color:"#fff",display:"inline-block"},icon:{display:"block"}}},n.style&&(cn(i.option.style.menu,n.style.menu),cn(i.option.style.triangle,n.style.triangle),cn(i.option.style.item,n.style.item),cn(i.option.style.icon,n.style.icon)),i.easyMarker=null,i.menuElement=null,i.itemMap=new Qn,i.positionRange={top:0,bottom:0,left:0},i.windowWidth=document.documentElement.clientWidth,i.ticking=!1,i.height=0,i.width=0,i.type=mn.SELECT,i.options={},i.createElement(),i.mount(),i.hide(),i}return $e(e,dn),K(e,[{key:"createElement",value:function(){var t=this,e=document.createElement("div");e.style.position="absolute",e.style.width="max-content",e.style.textAlign="center",e.style.lineHeight="0",e.style.zIndex="50",e.style.transform="translate3d(-50%, -100%, 0)",e.style.webkitTransform="translate3d(-50%, -100%, 0)",e.style.transition="transform 0.2s ease, opacity 0.2s ease";var n=document.createElement("div");n.classList.add("em-menu"),cn(n.style,this.option.style.menu);var i=document.createElement("div");i.classList.add("em-menu-triangle"),cn(i.style,this.option.style.triangle),e.appendChild(n),e.appendChild(i),this.option.items.forEach(function(e){var i=t.createMenuItemElement(e);t.itemMap.set(i,e),n.appendChild(i)}),this.menuElement=n,this.element=e;var o=document.createElement("style");o.type="text/css",o.rel="stylesheet";o.appendChild(document.createTextNode(".em-menu-wrapper-select .em-menu-item-highlight{display: none !important} .em-menu-wrapper-highlight .em-menu-item-select{display: none !important}")),document.getElementsByTagName("head")[0].appendChild(o)}},{key:"createMenuItemElement",value:function(t){var e=t.text,n=t.iconName,i=t.style,o=t.iconStyle,r=t.type,s=document.createElement("span");if(s.classList.add("em-menu-item"),void 0!==r&&s.classList.add("em-menu-item-"+r),cn(s.style,this.option.style.item,i),n){var h=document.createElement("span");cn(h.style,this.option.style.icon,o),h.className="em-menu-item-icon ".concat(n);var a=document.createTextNode(e);s.appendChild(h),s.appendChild(a)}else{var l=document.createTextNode(e);s.appendChild(l)}return s}},{key:"setPosition",value:function(t,e){var n=this,i={};if(this.mode===pn.REGION){var o=void 0;if(t.pageIndex!==e.pageIndex){var r=this.easyMarker.region.regions[e.pageIndex].regions[0].regions[0];o=this.easyMarker.region.getRects(r,e)}else o=this.easyMarker.region.getRects(t,e);o.forEach(function(t,e){0===e?(i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom):(i.left=Math.min(t.left,i.left),i.top=Math.min(t.top,i.top),i.right=Math.max(t.right,i.right),i.bottom=Math.max(t.bottom,i.bottom))})}else{var s=ti.getSelectNodeRectAndText(t.node,e.node,t.offset,e.offset).rects;s.filter(function(t){return t.left<=n.windowWidth&&t.left>=0}).forEach(function(t,e){0===e?(i.left=t.left-n.screenRelativeOffset.x,i.top=t.top-n.screenRelativeOffset.y,i.right=t.right-n.screenRelativeOffset.x,i.bottom=t.bottom-n.screenRelativeOffset.y):e===s.length-1?i.bottom=t.bottom-n.screenRelativeOffset.y:(i.left=Math.min(t.left-n.screenRelativeOffset.x,i.left),i.right=Math.max(t.right-n.screenRelativeOffset.x,i.right))})}this.positionRange.top=i.top,this.positionRange.bottom=i.bottom,this.positionRange.left=(i.left+i.right)/2}},{key:"hide",value:function(){this.style.visibility="hidden",this.style.opacity="0",this.reset()}},{key:"reset",value:function(){this.options={}}},{key:"show",value:function(){this.type===mn.HIGHLIGHT?(this.element.classList.remove("em-menu-wrapper-select"),this.element.classList.add("em-menu-wrapper-highlight")):this.type===mn.SELECT&&(this.element.classList.remove("em-menu-wrapper-highlight"),this.element.classList.add("em-menu-wrapper-select"));var t=0;this.height&&this.width||(this.height=Number((window.getComputedStyle(this.menuElement).height||"").replace("px","")),this.width=Number((window.getComputedStyle(this.menuElement).width||"").replace("px","")));var e=this.container.getBoundingClientRect(),n=e.top,i=e.right,o=e.left;if(n<0&&this.positionRange.bottom<-n?(t=this.positionRange.bottom,this.style.position="absolute"):this.positionRange.top-this.height-this.option.topOffset>-n?(t=this.positionRange.top,this.style.position="absolute"):(this.style.position="fixed",t=this.option.topOffset+this.height),this.style.visibility="visible",this.style.top=t+"px",this.positionRange.left+o+this.width/2>this.windowWidth){var r=void 0;"fixed"!==this.style.position||this.option.isMultiColumnLayout?r=i-this.positionRange.left-o-this.width/2:(r=i-this.positionRange.left-this.width/2,r=o<0?-this.width/2:r),this.style.right=r+"px",this.style.left=""}else if(this.positionRange.left+o-this.width/2<0){var s=void 0;s="fixed"!==this.style.position||this.option.isMultiColumnLayout?this.width/2+this.positionRange.left:(s=this.width/2+this.positionRange.left+o)<0?this.width/2:s,this.style.left=s+"px",this.style.right=""}else{var h=void 0;h="fixed"!==this.style.position||this.option.isMultiColumnLayout?this.positionRange.left:(h=this.positionRange.left+o)<0?this.width/2:h,this.style.left=h+"px",this.style.right=""}this.style.opacity="1"}},{key:"copyListener",value:function(t,e){var n=void 0;if(this.itemMap.forEach(function(t){"copy"!==t.id&&"复制"!==t.text||(n=t)}),n){var i=this.getSelection(t);n.id&&this.easyMarker.menuOnClick?this.easyMarker.menuOnClick(n.id,i,cn({},this.options,{e:e})):n.handler.call(this.easyMarker,i,cn({},this.options,{e:e}))}}},{key:"inRegion",value:function(t){var e=this.getTapTarget(t.target);return!!this.itemMap.has(e)}},{key:"handleTap",value:function(t,e){var n=this.getTapTarget(t.target);if(!this.itemMap.has(n))return!1;var i=this.getSelection(e),o=this.itemMap.get(n);return o.id&&this.easyMarker.menuOnClick?this.easyMarker.menuOnClick(o.id,i,this.options):o.handler.call(this.easyMarker,i,this.options),!0}},{key:"getSelection",value:function(t){var e=void 0;if(this.mode===pn.NODE){var n=t.start,i=t.end,o=t.content,r=t.markdown;e={anchorNode:n.node,anchorOffset:n.offset,focusNode:i.node,focusOffset:i.offset,toString:function(){return o},toMarkdown:function(){return r}}}else{var s=t.start,h=t.end,a=t.content,l=t.markdown;e={start:s,end:h,toString:function(){return a},toMarkdown:function(){return l}}}return e}},{key:"getTapTarget",value:function(t){return this.itemMap.has(t)?t:t.parentNode?this.getTapTarget(t.parentNode):null}},{key:"handleScroll",value:function(){var t=this;this.ticking||(window.requestAnimationFrame(function(){t.show(),t.ticking=!1}),this.ticking=!0)}},{key:"screenRelativeOffset",get:function(){return this.easyMarker?this.easyMarker.screenRelativeOffset:{x:0,y:0}}},{key:"isShow",get:function(){return"visible"===this.style.visibility}}]),e}(),ni=vt("iterator"),ii=h.isIterable=function(t){var e=Object(t);return void 0!==e[ni]||"@@iterator"in e||V.hasOwnProperty(Ze(e))},oi=n(function(t){t.exports={default:ii,__esModule:!0}});e(oi);var ri=h.getIterator=function(t){var e=en(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return k(e.call(t))},si=n(function(t){t.exports={default:ri,__esModule:!0}});e(si);var hi=e(n(function(t,e){e.__esModule=!0;var n=o(oi),i=o(si);function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,n.default)(Object(t)))return function(t,e){var n=[],o=!0,r=!1,s=void 0;try{for(var h,a=(0,i.default)(t);!(o=(h=a.next()).done)&&(n.push(h.value),!e||n.length!==e);o=!0);}catch(t){r=!0,s=t}finally{try{!o&&a.return&&a.return()}finally{if(r)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()})),ai={BLOCK:"block",LINE:"line"},li=function(t){function e(t,n){F(this,e);var i=Le(this,(e.__proto__||B(e)).call(this));return i.mode=n.mode||pn.NODE,i.maskType=n.maskType||(i.mode===pn.NODE?ai.BLOCK:ai.LINE),i.container=t,i.option=cn({color:"#FEFFCA",opacity:.5,animateDuration:100},n),i.maskType===ai.BLOCK?(i.paths=[],i.position={header:new Zn,body:new Zn,footer:new Zn},i.animateStartTime=0,i.animateEndTime=0,i.animatePercent=0,i.polygonElement=null):i.rects=[],i.animating=!1,i.easyMarker=null,i.createElement(),i.mount(),i}return $e(e,dn),K(e,[{key:"createElement",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.style.zIndex="20",t.style.pointerEvents="none",t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.overflow="visible",this.maskType===ai.BLOCK){var e=document.createElementNS("http://www.w3.org/2000/svg","polygon");e.style.fill=this.option.color,e.style.strokeWidth=0,e.style.strokeOpacity=this.option.opacity,e.style.opacity=this.option.opacity,e.style.transition="opacity 0.2s ease",t.appendChild(e),this.polygonElement=e}this.element=t}},{key:"render",value:function(t,e){if(this.mode===pn.NODE)if("line"===this.maskType){var n=void 0;try{n=ti.getSelectNodeRectAndText(t.node,e.node,t.offset,e.offset).rects}catch(t){console.error("EasyMarkerError:",t),n=[]}var i=Number(window.getComputedStyle(t.node.parentElement).lineHeight.replace("px",""));this.renderRectsLine(n,i)}else{var o=ti.getSelectRects(t,e),r=o.header,s=o.body,h=o.footer,a=bn(r,this.screenRelativeOffset),l=bn(s,this.screenRelativeOffset),u=bn(h,this.screenRelativeOffset);this.renderBlock(a,l,u)}if(this.mode===pn.REGION){var c=this.easyMarker.region.getRects(t,e);if("line"===this.maskType)this.renderRectsLine(c);else{var f=void 0,d=void 0,g=void 0;c.forEach(function(t,e){if(0===e)f=new Zn,g=new Zn,d=new Zn,f.setAll(t),g.setAll(t),d.setAll(t),g.y=t.y+t.height,g.height=0,d.height=0,d.y=t.y+t.height;else if(e===c.length-1)d.setAll(t),g.height=t.y-(f.y+f.height);else{var n=g.x+g.width,i=g.x;t.x<i&&(g.x=t.x),t.x+t.width>=n&&(g.width=t.x+t.width-g.x)}}),this.renderBlock(f,g,d)}}}},{key:"renderBlock",value:function(t,e,n){var i=this.position,o=i.header,r=i.body,s=i.footer;if(!(0!==this.paths.length&&o.equal(t)&&r.equal(e)&&s.equal(n))){this.polygonElement.style.opacity=this.option.opacity;var h=this.position;this.position.header.setAll(t),this.position.body.setAll(e),this.position.footer.setAll(n),this.animateStartTime=Date.now(),this.animateEndTime=this.animateStartTime+this.option.animateDuration,this.animatePercent=0,this.animating||(this.animating=!0,this.animated(h))}}},{key:"animated",value:function(t){var e=this,n=(Date.now()-this.animateStartTime)/(this.animateEndTime-this.animateStartTime),i=0;if(n>=1)i=1,this.animatePercent=1;else{var o=1e3/60/this.option.animateDuration+1.3*(n-this.animatePercent);this.animatePercent+=o,i=o>1?1:o/(1-n)}var r={header:this.constructor.getAnimateFrame(t.header,this.position.header,i),body:this.constructor.getAnimateFrame(t.body,this.position.body,i),footer:this.constructor.getAnimateFrame(t.footer,this.position.footer,i)};this.paths=this.constructor.getPaths(r);var s=this.paths.map(function(t){var e=hi(t,2);return e[0]+","+e[1]}).join(" ");this.polygonElement.setAttribute("points",s),n>=1?this.animating=!1:window.requestAnimationFrame(function(){return e.animated(r)})}},{key:"reset",value:function(){this.maskType===ai.BLOCK&&(this.paths=[],this.polygonElement.style.opacity="0",this.polygonElement.setAttribute("points","")),this.maskType===ai.LINE&&this.removeAllRectangle()}},{key:"renderRectsLine",value:function(t,e){var n=this;this.rects=t;var i=t.map(function(t){var i=0,o={x:0,y:0};return n.mode===pn.NODE&&(e=e||t.height,i=n.option.margin||(e-t.height)/4,o=n.screenRelativeOffset),_n(t,o,i)});this.animating||(this.animating=!0,window.requestAnimationFrame(function(){return n.renderRectsLineAnimated(i)}))}},{key:"renderRectsLineAnimated",value:function(t){var e=this;this.removeAllRectangle(),t.forEach(function(t){e.element.appendChild(e.createRectangle(t))}),this.animating=!1}},{key:"createRectangle",value:function(t){var e=t.reduce(function(t,e){var n=hi(e,2),i=n[0],o=n[1];return""===t?i+","+o:t+" "+i+","+o},""),n=document.createElementNS("http://www.w3.org/2000/svg","polygon");return n.style.fill=this.option.color,n.style.strokeWidth=0,n.style.strokeOpacity=this.option.opacity,n.style.opacity=this.option.opacity,n.setAttribute("points",e),n}},{key:"removeAllRectangle",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)}},{key:"screenRelativeOffset",get:function(){return this.easyMarker?this.easyMarker.screenRelativeOffset:{x:0,y:0}}},{key:"top",get:function(){return this.maskType===ai.BLOCK?this.position.header.y:this.rects[0]?this.mode===pn.NODE?this.rects[0].top-this.screenRelativeOffset.y:this.rects[0].top:0}},{key:"left",get:function(){return this.maskType===ai.BLOCK?this.position.header.x:this.rects[0]?this.mode===pn.NODE?this.rects[0].left-this.screenRelativeOffset.x:this.rects[0].left:0}},{key:"height",get:function(){if(this.maskType===ai.BLOCK)return this.position.header.height+this.position.body.height+this.position.footer.height;var t=this.rects[this.rects.length-1];return t?t.top+t.height:0}}],[{key:"getAnimateFrame",value:function(t,e,n){var i=new Zn;return i.x=t.x+(e.x-t.x)*n,i.y=t.y+(e.y-t.y)*n,i.height=t.height+(e.height-t.height)*n,i.width=t.width+(e.width-t.width)*n,i}},{key:"getPaths",value:function(t){var e=t.header,n=t.body,i=t.footer,o=[];return e.isSet&&(o.push([e.x,e.y]),o.push([e.x+e.width,e.y]),o.push([e.x+e.width,e.y+e.height])),n.isSet&&(o.push([n.x+n.width,n.y]),o.push([n.x+n.width,n.y+n.height])),i.isSet&&(o.push([i.x+i.width,i.y]),o.push([i.x+i.width,i.y+i.height]),o.push([i.x,i.y+i.height]),o.push([i.x,i.y])),n.isSet&&(o.push([n.x,n.y+n.height]),o.push([n.x,n.y])),e.isSet&&o.push([e.x,e.y+e.height]),o}}]),e}(),ui=function(t){function e(t,n){F(this,e);var i=Le(this,(e.__proto__||B(e)).call(this));return i.container=t,i.mode=n.mode||pn.NODE,i.option=cn({highlightColor:"#FEFFCA",underlineColor:"#af8978",underlineWidth:1,tagBackground:"#af8978",tagColor:"#fff",opacity:1,type:"highlight"},n),n.color&&(i.option.highlightColor=n.color),i.type=i.option.type||vn.Highlight,i.option.margin=En(i.option.margin),i.lineMap=new Qn,i.createElement(),i.mount(),i.id=0,i.easyMarker=null,i}return $e(e,dn),K(e,[{key:"getID",value:function(){return this.id++}},{key:"highlight",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=void 0===e||null===e?this.getID():e,r=void 0,s=void 0,h=[],a=void 0;if(this.mode===pn.NODE){var l=new ti(t.anchorNode,t.anchorOffset),u=new ti(t.focusNode,t.focusOffset);a=Number(window.getComputedStyle(t.anchorNode.parentElement).lineHeight.replace("px",""));var c=void 0,f=void 0;try{var d=ti.getSelectNodeRectAndText(l.node,u.node,l.offset,u.offset);c=d.rects,f=d.text}catch(t){console.error("EasyMarkerError:",t),c=[],f=""}var g=this.screenRelativeOffset;r=c.map(function(t){var e={top:t.top-g.y,bottom:t.bottom-g.y,height:t.height,width:t.width,left:t.left-g.x,right:t.right-g.x};h.push(e),a=a||t.height;var i=n.option.margin||(a-t.height)/4;return _n(t,g,i)});var p=void 0;if(this.easyMarker&&this.easyMarker.markdown){var v=this.easyMarker.markdown.getSelectMarkdown(l.node,u.node,l.offset,u.offset);p=v.markdown}else p="";s=cn({toString:function(){return f},toMarkdown:function(){return p}},t)}else{var y=t.start,m=t.end;h=this.easyMarker&&this.easyMarker.region.getRects(y,m);var w=this.easyMarker&&this.easyMarker.region.getText(y,m),x=this.easyMarker&&this.easyMarker.constructor.getSelectMarkdown();r=h.map(function(t){return _n(t,{x:0,y:0},0)}),s=cn({toString:function(){return w},toMarkdown:function(){return x}},t)}return this.lineMap.set(o,{selection:s,points:r,relativeRects:h,meta:i,lineHeight:a}),o}},{key:"render",value:function(){var t=this;this.removeAllRectangle(),this.lineMap.forEach(function(e){var n=e.meta.type||t.type;e.points.forEach(function(i,o){if(n===vn.UNDERLINE?t.element.appendChild(t.createLine(i)):t.element.appendChild(t.createRectangle(i)),e.points.length-1===o&&e.meta&&e.meta.tag){var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x",i[2][0]-5),r.setAttribute("y",i[2][1]+4),r.setAttribute("dominant-baseline","hanging"),r.setAttribute("text-anchor","end"),r.setAttribute("font-size","10"),r.setAttribute("fill",t.option.tagColor),r.textContent=e.meta.tag,r.classList.add("em-highlight-tag-text"),t.element.appendChild(r);var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("x",i[2][0]-25-5),s.setAttribute("y",i[2][1]-0),s.setAttribute("rx",2),s.setAttribute("ry",2),s.setAttribute("width",30),s.setAttribute("height",16),s.setAttribute("fill",t.option.tagBackground),t.element.insertBefore(s,r)}})})}},{key:"highlightLines",value:function(t){var e=this;this.lineMap.clear();var n=t.map(function(t){var n=t.selection,i=t.id,o=t.meta;return e.highlight(n,i,o)});return this.render(),n}},{key:"highlightLine",value:function(t,e,n){var i=this.highlight(t,e,n);return this.render(),i}},{key:"cancelHighlightLine",value:function(t){this.lineMap.delete(t),this.render()}},{key:"createElement",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.style.zIndex="10",t.style.pointerEvents="none",t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.overflow="visible",this.element=t}},{key:"createLine",value:function(t){var e=t[2][0],n=t[2][1]+1,i=t[3][0],o=t[3][1]+1,r=document.createElementNS("http://www.w3.org/2000/svg","line");return r.style.stroke=this.option.underlineColor,r.style.strokeWidth=this.option.underlineWidth,r.setAttribute("x1",e),r.setAttribute("y1",n),r.setAttribute("x2",i),r.setAttribute("y2",o),r}},{key:"createRectangle",value:function(t){var e=t.reduce(function(t,e){var n=hi(e,2),i=n[0],o=n[1];return""===t?i+","+o:t+" "+i+","+o},""),n=document.createElementNS("http://www.w3.org/2000/svg","polygon");return n.style.fill=this.option.highlightColor,n.style.strokeWidth=0,n.style.strokeOpacity=this.option.opacity,n.style.opacity=this.option.opacity,n.setAttribute("points",e),n}},{key:"handleTap",value:function(t){var e=xn(t),n=e.x,i=e.y,o=this.container.getBoundingClientRect(),r=o.top,s=o.left,h=void 0;return this.lineMap.forEach(function(t,e){for(var o=0;o<t.relativeRects.length;o++){var a=t.relativeRects[o],l=t.lineHeight?(t.lineHeight-a.height)/2:0;if(Tn(n-s,i-r,a,l)){h={id:e,line:t};break}}}),!(!h||!this.easyMarker)&&(this.easyMarker.highlightLineClick?this.easyMarker.highlightLineClick(h.id,h.line.meta,h.line.selection,t):this.easyMarker.showHighlightMenu(h.line.selection,{id:h.id,meta:h.line.meta}),!0)}},{key:"inRegion",value:function(t){var e=xn(t),n=e.x,i=e.y,o=this.container.getBoundingClientRect(),r=o.top,s=o.left,h=void 0;return this.lineMap.forEach(function(t,e){for(var o=0;o<t.relativeRects.length;o++){var a=t.relativeRects[o],l=t.lineHeight?(t.lineHeight-a.height)/2:0;if(Tn(n-s,i-r,a,l)){h={id:e,line:t};break}}}),!(!h||!this.easyMarker)}},{key:"removeAllRectangle",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)}},{key:"screenRelativeOffset",get:function(){return this.easyMarker?this.easyMarker.screenRelativeOffset:{x:0,y:0}}}]),e}(),ci=Bt.onFreeze;A("freeze",function(t){return function(e){return t&&x(e)?t(ci(e)):e}});var fi=h.Object.freeze,di=e(n(function(t){t.exports={default:fi,__esModule:!0}}))({H1:function(t){return"\n# "+t+"\n\n"},H2:function(t){return"\n## "+t+"\n\n"},H3:function(t){return"\n### "+t+"\n\n"},H4:function(t){return"\n#### "+t+"\n\n"},H5:function(t){return"\n##### "+t+"\n\n"},H6:function(t){return"\n###### "+t+"\n\n"},P:function(t){return t+"\n\n"},FIGCAPTION:function(t){return t+"\n\n"},STRONG:function(t){return"**"+t+"**"},B:function(t){return"**"+t+"**"},EM:function(t){return"*"+t+"*"},I:function(t){return"*"+t+"*"},S:function(t){return"~~"+t+"~~"},INS:function(t){return"++"+t+"++"},IMG:function(t){return"!["+t.alt+"]("+t.src+"?size="+t.width+"x"+t.height+")\n"},UL:function(t,e){return e.listLevel>1?"\n"+t:"\n"+t+"\n\n"},OL:function(t,e){return e.listLevel>1?"\n"+t:"\n"+t+"\n\n"},LI:function(t,e){for(var n="",i=1;i<e.itemLevel;i++)n+="    ";var o="\n";return(e.hasChild||e.isLastOne)&&(o=""),"UL"===e.type?n+"- "+t+o:""+n+e.index+". "+t+o}}),gi=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F(this,t),this.container=e,this.wrapMarkdown=t.wrapMarkdown,this.options=cn({},di,n)}return K(t,[{key:"getSelectMarkdown",value:function(t,e,n,i,o){var r={markdown:""},s="";if(void 0===o&&(o=[]),t.childNodes.length>0&&"SCRIPT"!==t.nodeName&&"STYLE"!==t.nodeName){var h=t.childNodes[0],a=this.getSelectMarkdown(h,e,0,i,o).markdown;return r.markdown=a,r}if("#text"===t.nodeName){var l=t,u=[],c=t===e?i:t.textContent.length,f=t.textContent.substring(n,c).replace(/(^\s*)|(\s*$)/g,"");0!==o.length&&l.parentNode===o[o.length-1].node&&(s=f);for(var d=!1;!d&&(0===o.length||l.parentNode!==o[o.length-1].node);){l===this.container&&(d=!0);var g="";"#text"===l.nodeName&&(g=f),l=l.parentNode,u.push({node:l,text:g})}for(;0!==u.length;)o.push(u.pop())}if("IMG"===t.nodeName&&(o.length>0?o[o.length-1].text+=this.wrapMarkdown(t,this.options):r.markdown+=this.wrapMarkdown(t,this.options)),t===e){if(0!==o.length){var p=o.pop();p.text+=s,r.markdown=this.wrapMarkdown(p.node,this.options,p.text),0!==o.length&&(o[o.length-1].text+=r.markdown)}for(;0!==o.length;){var v=o.pop();r.markdown=this.wrapMarkdown(v.node,this.options,v.text),0!==o.length&&(o[o.length-1].text+=r.markdown)}return r}var y=t.nextSibling;if(y){var m=this.getSelectMarkdown(y,e,0,i,o).markdown;o.length>0?o[o.length-1].text+=m:r.markdown+=m}else{var w=t.parentNode,x=o.pop();for(x.text+=s,r.markdown+=this.wrapMarkdown(x.node,this.options,x.text),0!==o.length&&(o[o.length-1].text+=r.markdown);w&&null===w.nextSibling;)w=w.parentNode,(x=o.pop()).text+=s,r.markdown=this.wrapMarkdown(x.node,this.options,x.text),0!==o.length&&(o[o.length-1].text+=r.markdown);if(!w)throw new Error("Invalid end node");var k=this.getSelectMarkdown(w.nextSibling,e,0,i,o).markdown;0!==o.length?o[o.length-1].text+=k:r.markdown=k}return r}}],[{key:"wrapMarkdown",value:function(t,e,n){if("IMG"===t.nodeName){var i={alt:t.alt,src:t.src,width:t.width,height:t.height};return e[t.nodeName]?e[t.nodeName](i):""}if("LI"===t.nodeName){for(var o=1,r=t.parentNode;r.parentNode;)(r=r.parentNode).nodeName===t.parentNode.nodeName&&o++;var s=!1;Nn(t.childNodes).some(function(t){return"UL"===t.nodeName||"OL"===t.nodeName})&&(s=!0);var h=!1;t.nextElementSibling||(h=!0);var a={type:t.parentNode.nodeName,isLastOne:h,itemLevel:o,hasChild:s,index:[].indexOf.call(t.parentNode.children,t)+1};return e[t.nodeName]?e[t.nodeName](n,a):n}if("UL"===t.nodeName||"OL"===t.nodeName){for(var l=1,u=t.parentNode;u.parentNode;)(u=u.parentNode).nodeName===t.nodeName&&l++;return e[t.nodeName]?e[t.nodeName](n,{listLevel:l}):n}return e[t.nodeName]?e[t.nodeName](n):n}}]),t}(),pi="touchstart",vi="touchmove",yi="touchmovethrottle",mi="touchend",wi="tap",xi="longtap",ki=function(){function t(e,n){F(this,t),this.disabled=!1,this.options={longTapTime:600,tapTime:500,slideDistance:20,throttleTime:50},this.element=e||window,this.options=cn(this.options,n),this.touchStartCallbacks=[],this.touchMoveCallbacks=[],this.touchMoveThrottleCallbacks=[],this.touchEndCallbacks=[],this.tapCallbacks=[],this.longTapCallbacks=[],this.hook=function(){return!0},this.touchStartPosition={x:0,y:0},this.longTapTimerHandler=null,this.touchMoveTimerHandler=null,this.touchStartTime=Date.now(),this.lastMoveTime=Date.now(),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.startEventName=Mn()===yn.MOBILE?"touchstart":"mousedown",this.moveEventName=Mn()===yn.MOBILE?"touchmove":"mousemove",this.endEventName=Mn()===yn.MOBILE?"touchend":"mouseup",this.cancelEventName=Mn()===yn.MOBILE?"touchcancel":"mouseleave",this.element.addEventListener(this.startEventName,this.onTouchStart),this.element.addEventListener(this.moveEventName,this.onTouchMove,{passive:!1}),this.element.addEventListener(this.endEventName,this.onTouchEnd),this.element.addEventListener(this.cancelEventName,this.onTouchEnd)}return K(t,[{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"registerEvent",value:function(t,e){if("function"==typeof e)switch(t){case pi:this.touchStartCallbacks.push(e);break;case vi:this.touchMoveCallbacks.push(e);break;case yi:this.touchMoveThrottleCallbacks.push(e);break;case mi:this.touchEndCallbacks.push(e);break;case wi:this.tapCallbacks.push(e);break;case xi:this.longTapCallbacks.push(e)}}},{key:"registerHook",value:function(t){this.hook=t}},{key:"onTouchStart",value:function(t){var e=this;this.disabled||t.touches&&t.touches.length>1||this.hook("touchstart",t)&&(this.touchStartCallbacks.forEach(function(e){return e(t)}),this.longTapTimerHandler=setTimeout(function(){e.onLongTap(t)},this.options.longTapTime),this.touchStartPosition=xn(t),this.touchStartTime=Date.now())}},{key:"onTouchMove",value:function(t){var e=this;this.disabled||(t.touches&&t.touches.length>1||this.hook("touchmove",t)&&(this.touchMoveCallbacks.forEach(function(e){return e(t)}),clearTimeout(this.touchMoveTimerHandler),this.touchMoveTimerHandler=setTimeout(function(){e.onTouchMoveThrottle(t)},this.options.throttleTime),Date.now()-this.lastMoveTime>this.options.throttleTime&&(this.lastMoveTime=Date.now(),this.onTouchMoveThrottle(t)),kn(xn(t),this.touchStartPosition)>this.options.slideDistance&&(clearTimeout(this.longTapTimerHandler),this.longTapTimerHandler=null)))}},{key:"onTouchEnd",value:function(t){if(!this.disabled&&(!(t.touches&&t.touches.length>1)&&this.hook("touchmove",t)&&(this.touchEndCallbacks.forEach(function(e){return e(t)}),clearTimeout(this.longTapTimerHandler),this.longTapTimerHandler=null,Date.now()-this.touchStartTime<this.options.tapTime&&kn(xn(t),this.touchStartPosition)<this.options.slideDistance))){t.preventDefault();var e=this.constructor.createMouseEvent("click",t);this.onTap(t),t.target.dispatchEvent(e)}}},{key:"onTouchMoveThrottle",value:function(t){this.touchMoveThrottleCallbacks.forEach(function(e){return e(t)})}},{key:"onTap",value:function(t){this.disabled||this.hook("tap",t)&&this.tapCallbacks.forEach(function(e){return e(t)})}},{key:"onLongTap",value:function(t){this.disabled||this.longTapCallbacks.forEach(function(e){return e(t)})}},{key:"destroy",value:function(){this.element.removeEventListener(this.startEventName,this.onTouchStart),this.element.removeEventListener(this.moveEventName,this.onTouchMove),this.element.removeEventListener(this.endEventName,this.onTouchEnd),this.element.removeEventListener(this.cancelEventName,this.onTouchEnd)}}],[{key:"createMouseEvent",value:function(t,e){var n=On(e),i=new MouseEvent(t);return i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,i}}]),t}(),Ei={disableSelect:!1,menuItems:[],menuTopOffset:0,isMultiColumnLayout:!1,cursor:{same:!1},scrollOffsetBottom:100,scrollSpeedLevel:4,adjustTextStyleDisabled:!1},bi=function(t){return t.preventDefault()},Si=function(){},Ti=function(){function t(e){F(this,t),this.options=cn({},Ei,e),this.$selectStatus=gn.NONE,this.windowHeight=null,this.container=null,this.scrollContainer=null,this.excludeElements=[],this.includeElements=[],this.highlight=null,this.movingCursor=null,this.touchEvent=null,this.scrollInterval=null,this.cursor={start:null,end:null},this.mask=null,this.menu=null,this.scrollOffsetBottom=null,this.scrollSpeedLevel=null,this.containerScroll=null,this.deviceType=Mn(),this.selectStatusChangeHandler=function(){},this.menuOnClick=function(){},this.highlightLineClick=null}return K(t,[{key:"create",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.container=t,this.adjustTextStyle(),this.container.oncontextmenu=function(t){t.returnValue=!1},this.windowHeight=document.documentElement.clientHeight,i.constructor===Object?(this.excludeElements=i.excludeElements?[].concat(hn(i.excludeElements)):[],this.includeElements=i.includeElements?[].concat(hn(i.includeElements)):[t]):(this.excludeElements=[].concat(hn(i)),this.includeElements=[t]),this.scrollContainer=e||document.body,this.container.addEventListener("contextmenu",bi),Si=function(t){return n.copyListener(t)},document.addEventListener("copy",Si),this.scrollContainer===document.body?this.scrollContainer.onscroll=this.handleScroll.bind(this):(this.containerScroll=function(){n.handleScroll()},this.scrollContainer.addEventListener("scroll",this.containerScroll)),this.container.style.userSelect="none",this.container.style.webkitUserSelect="none",this.container.style.position="relative",this.touchEvent=new ki(this.container),this.options.disableSelect||(this.touchEvent.registerEvent(pi,this.handleTouchStart.bind(this)),this.touchEvent.registerEvent(vi,this.handleTouchMove.bind(this)),this.touchEvent.registerEvent(yi,this.handleTouchMoveThrottle.bind(this)),this.touchEvent.registerEvent(mi,this.handleTouchEnd.bind(this)),this.touchEvent.registerEvent(xi,this.handleLongTap.bind(this))),this.touchEvent.registerEvent(wi,this.handleTap.bind(this));var o=this.options.cursor&&this.options.cursor.Cursor?this.options.cursor.Cursor:An;this.options.cursor.same?this.cursor.start=new o(this.container,In,cn({mode:this.mode},this.options.cursor||{})):this.cursor.start=new o(this.container,Ln,cn({mode:this.mode},this.options.cursor||{})),this.cursor.end=new o(this.container,In,this.options.cursor||{}),this.movingCursor=this.cursor.end,this.mask=new li(this.container,cn({mode:this.mode},this.options.mask||{})),this.highlight=new ui(this.container,cn({mode:this.mode},this.options.highlight||{})),this.menu=new ei(this.container,{menuItems:this.options.menuItems,topOffset:this.options.menuTopOffset,style:this.options.menuStyle,isMultiColumnLayout:this.options.isMultiColumnLayout,mode:this.mode}),this.menu.easyMarker=this,this.highlight.easyMarker=this,this.mask.easyMarker=this,this.markdown=new gi(this.container,this.options.markdownOptions),this.scrollOffsetBottom=En(this.options.scrollOffsetBottom),this.scrollSpeedLevel=this.options.scrollSpeedLevel}},{key:"disable",value:function(){this.touchEvent.disable()}},{key:"enable",value:function(){this.touchEvent.enable()}},{key:"highlightLine",value:function(t,e,n){this.highlight.highlightLine(t,e,n)}},{key:"highlightLines",value:function(t){this.highlight.highlightLines(t)}},{key:"cancelHighlightLine",value:function(t){this.highlight.cancelHighlightLine(t)}},{key:"onHighlightLineClick",value:function(t){this.highlightLineClick=t}},{key:"onSelectStatusChange",value:function(t){this.selectStatusChangeHandler=t}},{key:"onMenuClick",value:function(t){this.menuOnClick=t}},{key:"registerEventHook",value:function(t){this.touchEvent.registerHook(t)}},{key:"destroy",value:function(){this.container.oncontextmenu=null,this.container.removeEventListener("contextmenu",bi),document.removeEventListener("copy",Si),null!==this.containerScroll&&(this.scrollContainer.removeEventListener("scroll",this.containerScroll),this.containerScroll=null),this.scrollContainer.onscroll=null,this.touchEvent.destroy(),this.cursor.start.destroy(),this.cursor.end.destroy(),this.mask.destroy(),this.highlight.destroy(),this.menu.destroy(),this.$selectStatus=gn.NONE,this.container=null,this.scrollContainer=null,this.excludeElements=[],this.highlight=null,this.movingCursor=null,this.touchEvent=null,this.cursor={start:null,end:null},this.mask=null,this.menu=null,this.windowHeight=null,this.includeElements=[],this.scrollInterval=null,this.scrollOffsetBottom=null,this.scrollSpeedLevel=null,this.selectStatusChangeHandler=function(){},this.menuOnClick=function(){},this.highlightLineClick=null}},{key:"reset",value:function(){this.selectStatus=gn.NONE,this.cursor.start.hide(),this.cursor.end.hide(),this.mask.reset(),this.menu.hide()}},{key:"adjustTextStyle",value:function(){if(!this.options.adjustTextStyleDisabled)for(var t=this.container.children,e=0;e<t.length;e++)t[e].style.zIndex="40",t[e].style.position="relative"}},{key:"isContains",value:function(t){return-1!==this.includeElements.findIndex(function(e){return e.contains(t)})&&-1===this.excludeElements.findIndex(function(e){return e.contains(t)})}},{key:"handleLongTap",value:function(){}},{key:"handleTap",value:function(){}},{key:"copyListener",value:function(){}},{key:"handleTouchStart",value:function(t){if(this.selectStatus===gn.FINISH&&this.menu.isShow&&this.menu.type!==mn.HIGHLIGHT){var e=this.getTouchRelativePosition(t),n=this.cursor.start.inRegion(e),i=this.cursor.end.inRegion(e);n.inRegion&&i.inRegion?(this.selectStatus=gn.SELECTING,this.movingCursor=n.distance<i.distance?this.cursor.start:this.cursor.end):i.inRegion?(this.selectStatus=gn.SELECTING,this.movingCursor=this.cursor.end):n.inRegion&&(this.selectStatus=gn.SELECTING,this.movingCursor=this.cursor.start)}}},{key:"handleTouchMove",value:function(t){this.selectStatus===gn.SELECTING&&t.preventDefault()}},{key:"handleTouchMoveThrottle",value:function(t){var e=this;if(this.selectStatus===gn.SELECTING){var n=this.deviceType===yn.MOBILE?this.movingCursor.height/2:0,i=this.movingCursor.offset||{x:0,y:-n},o=On(t),r=t.clientY||o.clientY;if(r>=this.windowHeight-this.scrollOffsetBottom){null!==this.scrollInterval&&clearInterval(this.scrollInterval);var s=(r-this.windowHeight+this.scrollOffsetBottom)*this.scrollSpeedLevel/this.scrollOffsetBottom;this.scrollInterval=setInterval(function(){e.scrollContainer.scrollTop+=s,document.documentElement.scrollTop+=s},1)}else clearInterval(this.scrollInterval);var h=xn(t,i),a=h.x,l=h.y,u=document.elementFromPoint(a,l);u instanceof HTMLIFrameElement&&(u=u.contentWindow.document.elementFromPoint(a,l)),this.isContains(u)&&this.moveCursor(u,a,l)}}},{key:"handleTouchEnd",value:function(){this.selectStatus===gn.SELECTING&&this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null)}},{key:"handleScroll",value:function(){this.selectStatus===gn.FINISH&&this.menu.handleScroll()}},{key:"showHighlightMenu",value:function(t,e){this.setSelection(t),this.selectStatus=gn.FINISH,this.menu.setPosition(this.start,this.end),this.menu.type=mn.HIGHLIGHT,this.menu.options=e,this.menu.show()}},{key:"setSelection",value:function(){}},{key:"getTouchRelativePosition",value:function(t){var e=xn(t,{x:0,y:-(this.deviceType===yn.MOBILE?this.movingCursor.height/2:0)});return e.x-=this.screenRelativeOffset.x,e.y-=this.screenRelativeOffset.y,e}},{key:"selectStatus",get:function(){return this.$selectStatus},set:function(t){t!==this.$selectStatus&&this.selectStatusChangeHandler(t),this.$selectStatus=t,t===gn.FINISH?(this.menu.setPosition(this.start,this.end),this.menu.type=mn.SELECT,this.menu.show()):this.menu.hide()}},{key:"screenRelativeOffset",get:function(){var t=this.container.getBoundingClientRect(),e=t.top;return{x:t.left,y:e}}}],[{key:"create",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=new this;return i.create(t,e,n),i}}]),t}(),Ri=function(t){function e(t){F(this,e);var n=Le(this,(e.__proto__||B(e)).call(this,t));return n.textNode={start:null,end:null},n.markdown=null,n.mode=pn.NODE,n.touchStartTime=0,n}return $e(e,Ti),K(e,[{key:"getSelectText",value:function(){var t=ti.getSelectText(this.textNode.start,this.textNode.end)||"";return function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e="",n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").replace(/\s+/g,""),i=0,o=0;i<t.length;i++){if(o>=n.length)return e;t[i]===n[o]?(e+=t[i],o++):t[i].match(/\n|\r|\s/)?""!==e&&(e+=t[i]):(i-=e.length,o=0,e="")}return e}(this.container.innerText,t)||t}},{key:"getSelectMarkdown",value:function(){return this.markdown.getSelectMarkdown(this.textNode.start.node,this.textNode.end.node,this.textNode.start.offset,this.textNode.end.offset).markdown||""}},{key:"swapCursor",value:function(t,e){var n=e.x,i=e.y;if(this.movingCursor===this.cursor.start){var o=this.cursor.end.position;i>o.y||i===o.y&&n>=o.x?(this.cursor.start.position=this.cursor.end.position,this.movingCursor=this.cursor.end,this.textNode.start=new ti(this.textNode.end.node,this.textNode.end.offset),this.textNode.end=new ti(t.node,t.index)):this.textNode.start=new ti(t.node,t.index)}else{var r=this.cursor.start.position;i<r.y||i===r.y&&n<=r.x?(this.cursor.end.position=this.cursor.start.position,this.movingCursor=this.cursor.start,this.textNode.end=new ti(this.textNode.start.node,this.textNode.start.offset),this.textNode.start=new ti(t.node,t.index)):this.textNode.end=new ti(t.node,t.index)}}},{key:"selectWords",value:function(t,e,n){var i=function t(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];if(!e||e&&!e.childNodes)return null;for(var r=Number(window.getComputedStyle(e).lineHeight.replace("px","")),s=0;s<e.childNodes.length;s++){var h=e.childNodes[s];if("#text"===h.nodeName)for(var a=Sn(h.textContent,o),l=0,u=document.createRange(),c=0;c<a.length;c++){var f=a[c].length;u.setStart(h,l),u.setEnd(h,l+f);for(var d=u.getClientRects(),g=0;g<d.length;g++){var p=d[g],v=((r=r||p.height)-p.height)/2;if(p.left<n&&p.right>n&&p.top-v<i&&p.bottom+v>i){for(var y=[],m=0;m<d.length;m++){var w=d[m];y.push(cn({},w,{top:w.top-v,height:r,bottom:w.bottom+v,left:w.left,right:w.right,width:w.width}))}return{node:h,rects:y,textRects:d,index:l,wordsLength:f}}}l+=f}else{if("#comment"===h.nodeName)continue;var x=t(h,n,i,o);if(x)return x}}return null}(t,e,n,["。”","？”","！”","。","？","！"])||{},o=i.rects,r=i.node,s=i.index,h=i.wordsLength;if(o&&(!o||0!==o.length)){var a=o[0],l=o[o.length-1],u=a.left-this.screenRelativeOffset.x,c=a.top-this.screenRelativeOffset.y;this.textNode.start=new ti(r,s),this.cursor.start.height=a.height,this.cursor.start.position={x:u,y:c};var f=l.left-this.screenRelativeOffset.x,d=l.top-this.screenRelativeOffset.y;this.textNode.end=new ti(r,s+h),this.cursor.end.height=l.height,this.cursor.end.position={x:f+l.width,y:d},this.cursor.start.show(),this.cursor.end.show(),this.renderMask(),this.selectStatus=gn.FINISH}}},{key:"renderMask",value:function(){this.mask.render(this.textNode.start,this.textNode.end)}},{key:"moveCursor",value:function(t,e,n){var i=wn(t,e,n,this.movingCursor===this.cursor.start);if(null!==i){var o=i.x-this.screenRelativeOffset.x,r=i.y-this.screenRelativeOffset.y,s=this.movingCursor===this.cursor.start?this.cursor.end:this.cursor.start;s.position.x===o&&s.position.y===r||(this.swapCursor(i,{x:o,y:r}),this.movingCursor.height=i.height,this.movingCursor.position={x:o,y:r},this.cursor.start.show(),this.cursor.end.show(),this.renderMask())}}},{key:"handleTouchStart",value:function(t){if(je(e.prototype.__proto__||B(e.prototype),"handleTouchStart",this).call(this,t),this.deviceType===yn.PC){if(this.selectStatus===gn.FINISH){var n=this.menu.inRegion(t),i=this.getTouchRelativePosition(t),o=this.cursor.start.inRegion(i),r=this.cursor.end.inRegion(i);n||o.inRegion||r.inRegion||this.reset()}if(this.selectStatus===gn.NONE&&this.isContains(t.target)){this.touchStartTime=Date.now();var s=xn(t),h=s.x,a=s.y,l=wn(document.elementFromPoint(h,a),h,a,this.movingCursor!==this.cursor.start);if(l&&(this.textNode.start=new ti(l.node,l.index),this.textNode.start)){var u=l.x-this.screenRelativeOffset.x,c=l.y-this.screenRelativeOffset.y;this.cursor.start.height=l.height,this.cursor.start.position={x:u,y:c}}}}}},{key:"handleTouchMoveThrottle",value:function(t){if(this.deviceType===yn.PC&&this.selectStatus===gn.NONE&&this.textNode.start&&!this.textNode.end){if(Date.now()-this.touchStartTime<100)return;var n=xn(t),i=n.x,o=n.y,r=wn(document.elementFromPoint(i,o),i,o,this.movingCursor===this.cursor.start);if(r&&(this.textNode.end=new ti(r.node,r.index),this.textNode.end)){var s=r.x-this.screenRelativeOffset.x,h=r.y-this.screenRelativeOffset.y;this.cursor.end.height=r.height,this.cursor.end.position={x:s,y:h},this.selectStatus=gn.SELECTING}}je(e.prototype.__proto__||B(e.prototype),"handleTouchMoveThrottle",this).call(this,t)}},{key:"copyListener",value:function(t){this.selectStatus===gn.FINISH&&(this.menu.copyListener({start:this.textNode.start,end:this.textNode.end,content:this.getSelectText(),markdown:this.getSelectMarkdown()},t),this.reset())}},{key:"handleTap",value:function(t){if(this.selectStatus===gn.FINISH){this.menu.handleTap(t,{start:this.textNode.start,end:this.textNode.end,content:this.getSelectText(),markdown:this.getSelectMarkdown()});var e=this.getTouchRelativePosition(t),n=this.cursor.start.inRegion(e),i=this.cursor.end.inRegion(e);if(n.inRegion||i.inRegion)return;this.reset()}else if(this.selectStatus===gn.NONE){if(!this.highlight.handleTap(t)&&!this.options.disableTapHighlight&&!this.options.disableSelect&&this.isContains(t.target)&&this.deviceType===yn.MOBILE){var o=xn(t),r=o.x,s=o.y;this.selectWords(t.target,r,s)}}}},{key:"handleLongTap",value:function(t){if(this.deviceType===yn.MOBILE&&this.isContains(t.target)){var e=xn(t),n=e.x,i=e.y;this.selectWords(t.target,n,i)}}},{key:"handleTouchEnd",value:function(t){je(e.prototype.__proto__||B(e.prototype),"handleTouchEnd",this).call(this,t),this.selectStatus===gn.SELECTING&&(this.selectStatus=gn.FINISH),this.deviceType===yn.PC&&this.selectStatus===gn.NONE&&this.reset()}},{key:"setSelection",value:function(t){this.textNode.start=new ti(t.anchorNode,t.anchorOffset),this.textNode.end=new ti(t.focusNode,t.focusOffset)}},{key:"destroy",value:function(){je(e.prototype.__proto__||B(e.prototype),"destroy",this).call(this),this.textNode={start:null,end:null},this.markdown=null,this.mode=pn.NODE}},{key:"reset",value:function(){je(e.prototype.__proto__||B(e.prototype),"reset",this).call(this),this.textNode={start:null,end:null}}},{key:"start",get:function(){return this.textNode.start}},{key:"end",get:function(){return this.textNode.end}}]),e}(),Ni=function(){function t(e){F(this,t),this.originalRegionList=e,this.regions=[],this.initRectRegion()}return K(t,[{key:"initRectRegion",value:function(){this.regions=t.getLineRectRegionList(this.originalRegionList)}},{key:"setRegions",value:function(e){var n=t.getLineRectRegionList(e);this.originalRegionList=e,this.regions=n}},{key:"getSentenceByPosition",value:function(t){for(var e=void 0,n=void 0,i=this.getRegionByPoint(t),o=["。”","？”","！”","。","？","！"].reduce(function(t,e){return""===e?t:""===t?"\\"+e:t+"|\\"+e},""),r=new RegExp("("+o+")"),s=i;!n;){var h=this.getNextRegion(s);null===h?n=s:r.test(h.text)?n=h:s=h}for(var a=i;!e;){var l=this.getPreviousRegion(a);null===l?e=a:r.test(l.text)?e=a:a=l}return{start:e,end:n}}},{key:"getText",value:function(t,e){var n=t.originalIndex,i=e.originalIndex,o="";return this.originalRegionList.slice(n,i+1).forEach(function(t){o+=t.text}),o}},{key:"getRects",value:function(e,n){var i=e.pageIndex,o=n.pageIndex,r=e.lineIndex,s=n.lineIndex,h=e.columnIndex,a=n.columnIndex,l=[];if(r===s&&i===o){var u=this.regions[i].regions[r];return l.push(new DOMRect(e.left,u.top,n.left+n.width-e.left,u.height)),l}if(i===o){var c=this.regions[i].regions.slice(r,s+1);l.push.apply(l,hn(t.getRectsByRegions(c,h,a)))}else for(var f=i;f<=o;f++)if(f===i){var d=this.regions[f].regions.slice(r);l.push.apply(l,hn(t.getRectsByRegions(d,h,null)))}else if(f===o){var g=this.regions[f].regions.slice(0,s+1);l.push.apply(l,hn(t.getRectsByRegions(g,null,a)))}else{var p=this.regions[f].regions;l.push.apply(l,hn(t.getRectsByRegions(p,null,null)))}return l}},{key:"getRegionByPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={top:t.y,left:t.x};if(this.regions.length<=0)return null;var i=Cn(this.regions,n,"left",e);if(-1===i)return null;var o=this.regions[i].regions,r=Cn(o,n,"top",e);if(-1===r)return null;var s=o[r],h=Cn(s.regions,n,"left",e);return-1===h?null:s.regions[h]}},{key:"getLineInfoByRegion",value:function(t){var e=t.pageIndex,n=t.lineIndex,i=this.regions[e].regions[n];return{top:i.top,left:i.left,height:i.height,width:i.width}}},{key:"getPreviousRegion",value:function(t){var e=t.lineIndex,n=t.columnIndex,i=t.pageIndex,o=void 0;if(0===n){if(0!==e){var r=this.regions[i].regions[e-1];r&&(o=r.regions[r.regions.length-1])}else if(0!==i){var s=this.regions[i-1].regions[this.regions[i-1].region.length-1];s&&(o=s.regions[s.regions.length-1])}}else o=this.regions[i].regions[e].regions[n-1];return o||null}},{key:"getNextRegion",value:function(t){var e=t.lineIndex,n=t.columnIndex,i=t.pageIndex,o=void 0,r=this.regions[i].regions[e];if(r)if(n===r.regions.length-1){var s=this.regions[i].regions[e+1];if(s)o=hi(s.regions,1)[0];else if(this.regions[i+1]){o=hi(this.regions[i+1].regions[0].regions,1)[0]}}else o=r.regions[n+1];return o||null}},{key:"destroy",value:function(){this.originalRegionList=[],this.regions=[]}}],[{key:"getLineRectRegionList",value:function(e){var n=[],i={page:0,top:0,right:0,left:0,width:0,height:0,regions:[]},o={top:0,bottom:0,left:0,width:0,height:0,regions:[]},r=0,s=0,h=0;return e.forEach(function(a,l){var u=a.top,c=a.height,f=a.left,d=a.page,g=a.width;if(0===o.regions.length)i.page=a.page,i.top=u,i.right=f+g,i.left=f,i.width=g,o.top=u,o.bottom=u+c,o.left=f,o.height=c,o.page=d,o.regions.push(cn({originalIndex:l,lineIndex:r,columnIndex:s,pageIndex:h},a));else if(i.page===a.page&&t.isSameLine({top:o.top,height:o.bottom-o.top},a))s++,o.regions.push(cn({originalIndex:l,lineIndex:r,columnIndex:s,pageIndex:h},a)),o.top=Math.min(o.top,u),o.bottom=Math.max(o.bottom,u+c),o.height=Math.max(o.height,o.bottom-o.top);else if(i.page===a.page){r++,s=0;var p=o.regions[o.regions.length-1],v=p.width,y=p.left;o.width=y+v-o.left,i.regions.push(cn({},o)),i.top=Math.min(i.top,o.top),i.left=Math.min(i.left,o.left),i.right=Math.max(i.right,o.left+o.width),i.width=Math.max(i.width,i.right-o.left),o.top=u,o.bottom=u+c,o.left=f,o.height=c,o.page=d,o.regions=[],o.regions.push(cn({originalIndex:l,lineIndex:r,columnIndex:s,pageIndex:h},a))}else{var m=o.regions[o.regions.length-1],w=m.width,x=m.left;o.width=x+w-o.left,i.regions.push(cn({},o));var k=i.regions[i.regions.length-1],E=k.top,b=k.height;i.height=E+b-i.top,n.push(cn({},i)),h++,r=0,s=0,i.page=a.page,i.top=u,i.right=f+g,i.left=f,i.width=g,i.regions=[],o.top=u,o.bottom=u+c,o.left=f,o.height=c,o.page=d,o.regions=[],o.regions.push(cn({originalIndex:l,lineIndex:r,columnIndex:s,pageIndex:h},a))}if(l===e.length-1){var S=o.regions[o.regions.length-1],T=S.width,R=S.left;o.width=R+T-o.left,i.regions.push(cn({},o));var N=i.regions[i.regions.length-1],M=N.top,O=N.height;i.height=M+O-i.top,n.push(cn({},i))}}),n}},{key:"getRectsByRegions",value:function(t,e,n){var i=[];return t.forEach(function(o,r){if(0===r&&null!==e){var s=o.regions[e];i.push(new DOMRect(s.left,o.top,o.width-s.left+o.left,o.height))}else if(r===t.length-1&&null!==n){var h=o.regions[n];i.push(new DOMRect(o.left,o.top,h.left+h.width-o.left,o.height))}else i.push(new DOMRect(o.left,o.top,o.width,o.height))}),i}},{key:"pointInRect",value:function(t,e,n){return t.x>e.x&&t.x<=n.x&&t.y>e.y&&t.y<=n.y}},{key:"isSameLine",value:function(t,e){return(t.top-(e.top+e.height))*(e.top-(t.top+t.height))>0}}]),t}(),Mi=function(t){function e(t){F(this,e);var n=Le(this,(e.__proto__||B(e)).call(this,t));return n.selectRegion={start:null,end:null},n.region=new Ni(t.regions||[]),n.mode=pn.REGION,n.touchStartTime=0,n}return $e(e,Ti),K(e,[{key:"setRegions",value:function(t){this.region.setRegions(t)}},{key:"getSelectText",value:function(){return this.region.getText(this.selectRegion.start,this.selectRegion.end)||""}},{key:"handleTouchStart",value:function(t){if(je(e.prototype.__proto__||B(e.prototype),"handleTouchStart",this).call(this,t),this.deviceType===yn.PC){if(this.selectStatus===gn.FINISH){var n=this.menu.inRegion(t),i=this.getTouchRelativePosition(t),o=this.cursor.start.inRegion(i),r=this.cursor.end.inRegion(i);n||o.inRegion||r.inRegion||this.reset()}if(this.selectStatus===gn.NONE&&this.isContains(t.target)){this.touchStartTime=Date.now();var s=this.getTouchRelativePosition(t);if(this.selectRegion.start=this.region.getRegionByPoint(s,!0),this.selectRegion.start){var h=this.region.getLineInfoByRegion(this.selectRegion.start).height;this.cursor.start.height=h,this.cursor.start.position={x:this.selectRegion.start.left,y:this.selectRegion.start.top}}}}}},{key:"handleTouchMoveThrottle",value:function(t){if(this.deviceType===yn.PC&&this.selectStatus===gn.NONE&&this.selectRegion.start&&!this.selectRegion.end){if(Date.now()-this.touchStartTime<100)return;var n=this.getTouchRelativePosition(t);if(this.selectRegion.end=this.region.getRegionByPoint(n),this.selectRegion.end){var i=this.region.getLineInfoByRegion(this.selectRegion.end).height;this.cursor.end.height=i,this.cursor.end.position={x:this.selectRegion.end.left+this.selectRegion.end.width,y:this.selectRegion.end.top},this.selectStatus=gn.SELECTING}}je(e.prototype.__proto__||B(e.prototype),"handleTouchMoveThrottle",this).call(this,t)}},{key:"handleTouchEnd",value:function(t){je(e.prototype.__proto__||B(e.prototype),"handleTouchEnd",this).call(this,t),this.selectStatus===gn.SELECTING&&(this.selectStatus=gn.FINISH),this.deviceType===yn.PC&&this.selectStatus===gn.NONE&&this.reset()}},{key:"copyListener",value:function(t){this.selectStatus===gn.FINISH&&(this.menu.copyListener({start:this.selectRegion.start,end:this.selectRegion.end,content:this.getSelectText(),markdown:e.getSelectMarkdown()},t),this.reset())}},{key:"handleTap",value:function(t){if(this.selectStatus===gn.FINISH){this.menu.handleTap(t,{start:this.selectRegion.start,end:this.selectRegion.end,content:this.getSelectText(),markdown:e.getSelectMarkdown()});var n=this.getTouchRelativePosition(t),i=this.cursor.start.inRegion(n),o=this.cursor.end.inRegion(n);if(i.inRegion||o.inRegion)return;this.reset()}else if(this.selectStatus===gn.NONE){if(!this.highlight.handleTap(t)&&!this.options.disableTapHighlight&&!this.options.disableSelect&&this.isContains(t.target)&&this.deviceType===yn.MOBILE){var r=this.getTouchRelativePosition(t);this.selectThisSentence(r)}}}},{key:"handleLongTap",value:function(t){if(this.deviceType===yn.MOBILE&&this.isContains(t.target)){var e=this.getTouchRelativePosition(t);this.selectThisSentence(e)}}},{key:"selectThisSentence",value:function(t){var e=this.region.getSentenceByPosition(t),n=e.start,i=e.end;this.selectRegion={start:n,end:i},this.cursor.start.height=this.region.getLineInfoByRegion(this.selectRegion.start).height,this.cursor.start.position={x:this.selectRegion.start.left,y:this.selectRegion.start.top},this.cursor.end.height=this.region.getLineInfoByRegion(this.selectRegion.end).height,this.cursor.end.position={x:this.selectRegion.end.left+this.selectRegion.end.width,y:this.selectRegion.end.top},this.cursor.start.show(),this.cursor.end.show(),this.renderMask(),this.selectStatus=gn.FINISH}},{key:"moveCursor",value:function(t,e,n){var i=e-this.screenRelativeOffset.x,o=n-this.screenRelativeOffset.y,r=this.region.getRegionByPoint({x:i,y:o});if(r){var s=this.movingCursor===this.cursor.start?this.cursor.end:this.cursor.start;if(s.position.x!==i||s.position.y!==o){this.swapCursor(r,{x:i,y:o});var h=this.region.getLineInfoByRegion(r).height;this.movingCursor===this.cursor.start?(this.movingCursor.height=h,this.movingCursor.position={x:r.left,y:r.top}):(this.movingCursor.height=h,this.movingCursor.position={x:r.left+r.width,y:r.top}),this.cursor.start.show(),this.cursor.end.show(),this.renderMask()}}}},{key:"swapCursor",value:function(t){this.movingCursor===this.cursor.start?t.originalIndex>this.selectRegion.end.originalIndex?(this.cursor.start.position=this.cursor.end.position,this.movingCursor=this.cursor.end,this.selectRegion.start=this.region.getNextRegion(this.selectRegion.end),this.selectRegion.end=t):this.selectRegion.start=t:t.originalIndex<this.selectRegion.start.originalIndex?(this.cursor.end.position=this.cursor.start.position,this.movingCursor=this.cursor.start,this.selectRegion.end=this.region.getPreviousRegion(this.selectRegion.start),this.selectRegion.start=t):this.selectRegion.end=t}},{key:"renderMask",value:function(){this.mask.render(this.selectRegion.start,this.selectRegion.end)}},{key:"setSelection",value:function(t){this.selectRegion.start=t.start,this.selectRegion.end=t.end}},{key:"reset",value:function(){je(e.prototype.__proto__||B(e.prototype),"reset",this).call(this),this.selectRegion={start:null,end:null}}},{key:"destroy",value:function(){je(e.prototype.__proto__||B(e.prototype),"destroy",this).call(this),this.selectRegion={start:null,end:null},this.region.destroy(),this.region=null,this.mode=pn.REGION,this.touchStartTime=0}},{key:"start",get:function(){return this.selectRegion.start}},{key:"end",get:function(){return this.selectRegion.end}}],[{key:"getSelectMarkdown",value:function(){return"Markdown is not supported in current mode."}}]),e}();return t.NodeEasyMarker=Ri,t.RegionEasyMarker=Mi,t.default=Ri,t}({});
